2025-04-26 15:09:01,413 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:09:41,964 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:10:50,389 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:11:37,432 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:11:37,433 [INFO] __main__: ----- 配置参数 -----
2025-04-26 15:11:37,434 [INFO] __main__: 数据路径: ../data/
2025-04-26 15:11:37,434 [INFO] __main__: 批大小: 500
2025-04-26 15:11:37,434 [INFO] __main__: 每客户端样本数: 10000
2025-04-26 15:11:37,434 [INFO] __main__: 模型结构: 5层, 每层10个神经元, 'tanh'激活函数
2025-04-26 15:11:37,434 [INFO] __main__: 训练参数: 50轮, 客户端LR=0.02, 服务器LR=1.0
2025-04-26 15:11:37,435 [INFO] __main__: 模型保存位置: ./models//federated_model
2025-04-26 15:11:37,435 [INFO] __main__: ---------------------
2025-04-26 15:11:37,435 [INFO] __main__: === 开始模型训练 ===
2025-04-26 15:11:37,435 [INFO] __main__: 开始加载数据...
2025-04-26 15:11:37,435 [INFO] src.data_utils: 从以下位置加载数据: ../data/
2025-04-26 15:11:37,435 [ERROR] src.data_utils: 加载数据文件时出错: [Errno 13] Permission denied: '../data/'
2025-04-26 15:11:37,436 [ERROR] __main__: 数据加载失败: [Errno 13] Permission denied: '../data/'
Traceback (most recent call last):
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\src\main.py", line 125, in run_training
    train_data, valid_data, ec_min, ec_max, ec_mean = data_utils.preprocess_and_load_federated_data()
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\src\data_utils.py", line 63, in preprocess_and_load_federated_data
    zipfile = np.load(config.DATA_PATH, allow_pickle=True)
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\.venv\lib\site-packages\numpy\lib\npyio.py", line 417, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
PermissionError: [Errno 13] Permission denied: '../data/'
2025-04-26 15:11:37,437 [ERROR] __main__: === train 模式运行失败 ===
2025-04-26 15:12:12,081 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:12:12,083 [INFO] __main__: ----- 配置参数 -----
2025-04-26 15:12:12,083 [INFO] __main__: 数据路径: ./data
2025-04-26 15:12:12,083 [INFO] __main__: 批大小: 500
2025-04-26 15:12:12,083 [INFO] __main__: 每客户端样本数: 10000
2025-04-26 15:12:12,084 [INFO] __main__: 模型结构: 5层, 每层10个神经元, 'tanh'激活函数
2025-04-26 15:12:12,084 [INFO] __main__: 训练参数: 50轮, 客户端LR=0.02, 服务器LR=1.0
2025-04-26 15:12:12,084 [INFO] __main__: 模型保存位置: ./models//federated_model
2025-04-26 15:12:12,084 [INFO] __main__: ---------------------
2025-04-26 15:12:12,084 [INFO] __main__: === 开始模型训练 ===
2025-04-26 15:12:12,085 [INFO] __main__: 开始加载数据...
2025-04-26 15:12:12,085 [INFO] src.data_utils: 从以下位置加载数据: ./data
2025-04-26 15:12:12,085 [ERROR] src.data_utils: 在./data处未找到数据文件。请检查config.py中的路径。
2025-04-26 15:12:12,086 [ERROR] __main__: 数据加载失败: [Errno 2] No such file or directory: './data'
Traceback (most recent call last):
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\src\main.py", line 125, in run_training
    train_data, valid_data, ec_min, ec_max, ec_mean = data_utils.preprocess_and_load_federated_data()
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\src\data_utils.py", line 63, in preprocess_and_load_federated_data
    zipfile = np.load(config.DATA_PATH, allow_pickle=True)
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\.venv\lib\site-packages\numpy\lib\npyio.py", line 417, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: './data'
2025-04-26 15:12:12,088 [ERROR] __main__: === train 模式运行失败 ===
2025-04-26 15:12:46,280 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:12:46,281 [INFO] __main__: ----- 配置参数 -----
2025-04-26 15:12:46,282 [INFO] __main__: 数据路径: ./data
2025-04-26 15:12:46,282 [INFO] __main__: 批大小: 500
2025-04-26 15:12:46,282 [INFO] __main__: 每客户端样本数: 10000
2025-04-26 15:12:46,283 [INFO] __main__: 模型结构: 5层, 每层10个神经元, 'tanh'激活函数
2025-04-26 15:12:46,283 [INFO] __main__: 训练参数: 50轮, 客户端LR=0.02, 服务器LR=1.0
2025-04-26 15:12:46,283 [INFO] __main__: 模型保存位置: ./models//federated_model
2025-04-26 15:12:46,283 [INFO] __main__: ---------------------
2025-04-26 15:12:46,283 [INFO] __main__: === 开始模型训练 ===
2025-04-26 15:12:46,283 [INFO] __main__: 开始加载数据...
2025-04-26 15:12:46,284 [INFO] src.data_utils: 从以下位置加载数据: ./data
2025-04-26 15:12:46,284 [ERROR] src.data_utils: 在./data处未找到数据文件。请检查config.py中的路径。
2025-04-26 15:12:46,284 [ERROR] __main__: 数据加载失败: [Errno 2] No such file or directory: './data'
Traceback (most recent call last):
  File "main.py", line 125, in run_training
    train_data, valid_data, ec_min, ec_max, ec_mean = data_utils.preprocess_and_load_federated_data()
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\src\data_utils.py", line 63, in preprocess_and_load_federated_data
    zipfile = np.load(config.DATA_PATH, allow_pickle=True)
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\.venv\lib\site-packages\numpy\lib\npyio.py", line 417, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: './data'
2025-04-26 15:12:46,288 [ERROR] __main__: === train 模式运行失败 ===
2025-04-26 15:14:44,088 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:14:44,090 [INFO] __main__: ----- 配置参数 -----
2025-04-26 15:14:44,090 [INFO] __main__: 数据路径: ./data
2025-04-26 15:14:44,090 [INFO] __main__: 批大小: 500
2025-04-26 15:14:44,090 [INFO] __main__: 每客户端样本数: 10000
2025-04-26 15:14:44,091 [INFO] __main__: 模型结构: 5层, 每层10个神经元, 'tanh'激活函数
2025-04-26 15:14:44,091 [INFO] __main__: 训练参数: 50轮, 客户端LR=0.02, 服务器LR=1.0
2025-04-26 15:14:44,091 [INFO] __main__: 模型保存位置: ./models//federated_model
2025-04-26 15:14:44,091 [INFO] __main__: ---------------------
2025-04-26 15:14:44,091 [INFO] __main__: === 开始模型训练 ===
2025-04-26 15:14:44,091 [INFO] __main__: 开始加载数据...
2025-04-26 15:14:44,091 [INFO] src.data_utils: 从以下位置加载数据: ./data
2025-04-26 15:14:44,092 [ERROR] src.data_utils: 在./data处未找到数据文件。请检查config.py中的路径。
2025-04-26 15:14:44,092 [ERROR] __main__: 数据加载失败: [Errno 2] No such file or directory: './data'
Traceback (most recent call last):
  File "main.py", line 125, in run_training
    train_data, valid_data, ec_min, ec_max, ec_mean = data_utils.preprocess_and_load_federated_data()
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\src\data_utils.py", line 63, in preprocess_and_load_federated_data
    zipfile = np.load(config.DATA_PATH, allow_pickle=True)
  File "E:\xiangmu\Federated-learning-based-prediction-master\federated_model_optimization\.venv\lib\site-packages\numpy\lib\npyio.py", line 417, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: './data'
2025-04-26 15:14:44,094 [ERROR] __main__: === train 模式运行失败 ===
2025-04-26 15:15:11,416 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:17:00,119 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:17:00,121 [INFO] __main__: ----- 配置参数 -----
2025-04-26 15:17:00,122 [INFO] __main__: 数据路径: ../data/Office_Cold_6000-9000_6-10_13.npz
2025-04-26 15:17:00,122 [INFO] __main__: 批大小: 500
2025-04-26 15:17:00,122 [INFO] __main__: 每客户端样本数: 10000
2025-04-26 15:17:00,122 [INFO] __main__: 模型结构: 5层, 每层10个神经元, 'tanh'激活函数
2025-04-26 15:17:00,122 [INFO] __main__: 训练参数: 50轮, 客户端LR=0.02, 服务器LR=1.0
2025-04-26 15:17:00,123 [INFO] __main__: 模型保存位置: ./models//federated_model
2025-04-26 15:17:00,123 [INFO] __main__: ---------------------
2025-04-26 15:17:00,123 [INFO] __main__: === 开始模型训练 ===
2025-04-26 15:17:00,123 [INFO] __main__: 开始加载数据...
2025-04-26 15:17:00,123 [INFO] src.data_utils: 从以下位置加载数据: ../data/Office_Cold_6000-9000_6-10_13.npz
2025-04-26 15:17:00,136 [INFO] src.data_utils: 数据加载成功。形状: (47385, 7)
2025-04-26 15:17:00,137 [INFO] src.data_utils: 计算目标统计数据: Min=10.0000, Max=292.6400, Mean=78.2145
2025-04-26 15:17:00,139 [INFO] src.data_utils: 找到13个唯一的客户端名称。
2025-04-26 15:17:00,140 [INFO] src.data_utils: 分配11个客户端用于训练，1个用于验证。
2025-04-26 15:17:00,180 [INFO] src.data_utils: 为11个客户端准备联邦训练数据。
2025-04-26 15:17:00,180 [INFO] src.data_utils: 为1个客户端准备联邦验证数据。
2025-04-26 15:17:00,181 [INFO] __main__: 数据加载完成，数据统计信息: MIN=10.0000, MAX=292.6400, MEAN=78.2145
2025-04-26 15:17:00,181 [INFO] __main__: 设置TensorFlow Federated执行环境...
2025-04-26 15:17:00,181 [ERROR] __main__: TFF执行环境设置失败: module 'tensorflow_federated' has no attribute 'backends'
Traceback (most recent call last):
  File "main.py", line 138, in run_training
    tff.backends.native.set_local_execution_context()
AttributeError: module 'tensorflow_federated' has no attribute 'backends'
2025-04-26 15:17:00,182 [ERROR] __main__: === train 模式运行失败 ===
2025-04-26 15:22:10,843 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:22:10,844 [INFO] __main__: ----- 配置参数 -----
2025-04-26 15:22:10,846 [INFO] __main__: 数据路径: ../data/Office_Cold_6000-9000_6-10_13.npz
2025-04-26 15:22:10,846 [INFO] __main__: 批大小: 500
2025-04-26 15:22:10,846 [INFO] __main__: 每客户端样本数: 10000
2025-04-26 15:22:10,846 [INFO] __main__: 模型结构: 5层, 每层10个神经元, 'tanh'激活函数
2025-04-26 15:22:10,846 [INFO] __main__: 训练参数: 50轮, 客户端LR=0.02, 服务器LR=1.0
2025-04-26 15:22:10,846 [INFO] __main__: 模型保存位置: ./models//federated_model
2025-04-26 15:22:10,847 [INFO] __main__: ---------------------
2025-04-26 15:22:10,847 [INFO] __main__: === 开始模型训练 ===
2025-04-26 15:22:10,847 [INFO] __main__: 开始加载数据...
2025-04-26 15:22:10,847 [INFO] src.data_utils: 从以下位置加载数据: ../data/Office_Cold_6000-9000_6-10_13.npz
2025-04-26 15:22:10,857 [INFO] src.data_utils: 数据加载成功。形状: (47385, 7)
2025-04-26 15:22:10,858 [INFO] src.data_utils: 计算目标统计数据: Min=10.0000, Max=292.6400, Mean=78.2145
2025-04-26 15:22:10,860 [INFO] src.data_utils: 找到13个唯一的客户端名称。
2025-04-26 15:22:10,860 [INFO] src.data_utils: 分配11个客户端用于训练，1个用于验证。
2025-04-26 15:22:10,903 [INFO] src.data_utils: 为11个客户端准备联邦训练数据。
2025-04-26 15:22:10,904 [INFO] src.data_utils: 为1个客户端准备联邦验证数据。
2025-04-26 15:22:10,904 [INFO] __main__: 数据加载完成，数据统计信息: MIN=10.0000, MAX=292.6400, MEAN=78.2145
2025-04-26 15:22:10,904 [INFO] __main__: 设置TensorFlow Federated执行环境...
2025-04-26 15:22:10,904 [ERROR] __main__: TFF执行环境设置失败: module 'tensorflow_federated' has no attribute 'framework'
Traceback (most recent call last):
  File "main.py", line 138, in run_training
    tff.framework.set_default_executor(tff.framework.create_local_executor())
AttributeError: module 'tensorflow_federated' has no attribute 'framework'
2025-04-26 15:22:10,906 [ERROR] __main__: === train 模式运行失败 ===
2025-04-26 15:27:54,648 [INFO] src.model_definition: 定义BATCH_SPEC，输入形状: (?, 6)
2025-04-26 15:27:54,651 [INFO] __main__: ----- 配置参数 -----
2025-04-26 15:27:54,651 [INFO] __main__: 数据路径: ../data/Office_Cold_6000-9000_6-10_13.npz
2025-04-26 15:27:54,651 [INFO] __main__: 批大小: 500
2025-04-26 15:27:54,651 [INFO] __main__: 每客户端样本数: 10000
2025-04-26 15:27:54,652 [INFO] __main__: 模型结构: 5层, 每层10个神经元, 'tanh'激活函数
2025-04-26 15:27:54,652 [INFO] __main__: 训练参数: 50轮, 客户端LR=0.02, 服务器LR=1.0
2025-04-26 15:27:54,652 [INFO] __main__: 模型保存位置: ./models//federated_model
2025-04-26 15:27:54,652 [INFO] __main__: ---------------------
2025-04-26 15:27:54,652 [INFO] __main__: === 开始模型训练 ===
2025-04-26 15:27:54,653 [INFO] __main__: 开始加载数据...
2025-04-26 15:27:54,653 [INFO] src.data_utils: 从以下位置加载数据: ../data/Office_Cold_6000-9000_6-10_13.npz
2025-04-26 15:27:54,664 [INFO] src.data_utils: 数据加载成功。形状: (47385, 7)
2025-04-26 15:27:54,665 [INFO] src.data_utils: 计算目标统计数据: Min=10.0000, Max=292.6400, Mean=78.2145
2025-04-26 15:27:54,667 [INFO] src.data_utils: 找到13个唯一的客户端名称。
2025-04-26 15:27:54,667 [INFO] src.data_utils: 分配11个客户端用于训练，1个用于验证。
2025-04-26 15:27:54,711 [INFO] src.data_utils: 为11个客户端准备联邦训练数据。
2025-04-26 15:27:54,712 [INFO] src.data_utils: 为1个客户端准备联邦验证数据。
2025-04-26 15:27:54,712 [INFO] __main__: 数据加载完成，数据统计信息: MIN=10.0000, MAX=292.6400, MEAN=78.2145
2025-04-26 15:27:54,713 [INFO] __main__: 设置TensorFlow Federated执行环境...
2025-04-26 15:27:54,713 [ERROR] __main__: TFF执行环境设置失败: module 'tensorflow_federated' has no attribute 'framework'
Traceback (most recent call last):
  File "main.py", line 138, in run_training
    tff.framework.set_default_executor(tff.framework.create_local_executor())
AttributeError: module 'tensorflow_federated' has no attribute 'framework'
2025-04-26 15:27:54,714 [ERROR] __main__: === train 模式运行失败 ===
